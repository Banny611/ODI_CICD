<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.09" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="IMdNYaPQH+Jy2LozOyMsc3NUejJx8yTFsLPt2fNgzSQ=" keyVect="pPi6pTzEtXM/khbRVh8/Uw==" exportKeySalt="7576618c-c87b-444e-a149-e627ef424650" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String"><![CDATA[AP]]></Field>
	<Field name="DelegateClass" type="java.lang.String"><![CDATA[SparkKM]]></Field>
	<Field name="DelegateScript" type="java.lang.String"><![CDATA[

import oracle.odi.domain.odireference.*
import oracle.odi.domain.adapter.*
import oracle.odi.domain.adapter.topology.*
import oracle.odi.domain.adapter.relational.*
import oracle.odi.domain.adapter.project.*
import oracle.odi.domain.adapter.project.IKnowledgeModule.ProcessingType
import oracle.odi.domain.mapping.*
import oracle.odi.domain.mapping.component.*
import oracle.odi.domain.mapping.physical.*
import oracle.odi.domain.mapping.generator.*
import oracle.odi.domain.mapping.exception.*
import oracle.odi.domain.project.*
import oracle.odi.domain.model.*
import oracle.odi.mapping.generation.*
import oracle.odi.mapping.generation.spark.*
import oracle.odi.domain.topology.*
import oracle.odi.km.exception.OdiKMException
import oracle.odi.domain.topology.AbstractOdiDataServer.IConnectionSettings
import oracle.odi.domain.topology.AbstractOdiDataServer.JdbcSettings
import oracle.odi.mapping.generation.AbstractSyntaxTree.ASTProducerMethod;
import oracle.odi.domain.mapping.generator.KMGeneratorDelegateRegistry.GeneratorDelegateClass;

@GeneratorDelegateClass(componentType="AP", descriptionKey="GeneratorDelegateClass.SparkKM")
	public class SparkKM extends GroovyComponentGeneratorDelegateBase {
		protected GeneratorContext generatorContext;
		protected IMapComponent component;
		protected MapPhysicalNode physicalNode;
	
		
		public void setBinding(Binding binding) {
		 	
            Map variables = binding.getVariables();
		 	if (variables.containsKey("component")) {
              component =  binding.getVariable("component");
            }
		 	
		 	if (variables.containsKey("physicalNode")) {
              physicalNode =  binding.getVariable("physicalNode");
            }
          
        	  if (variables.containsKey("generatorContext")) {
              generatorContext =  (GeneratorContext)binding.getVariable("generatorContext");
            }
		 } 
		 
		 String getOptionValue(String optionName) throws AdapterException, GenerationException, oracle.odi.domain.mapping.exception.MappingException {
	        String value = physicalNode.getKMOptionValueString(optionName);
	        if (value != null && !value.equals("")) {
	            return value;
	        }
	        return null;
		 }
		   public void generateOdiOsCommand(MapPhysicalNode physicalNode, Binding variables) {
                String sparkPyFileName;
                String sparkPyExecFile;
                String sparkPyExecFileName;
                String sparkPyOutFile;
                String sparkPyErrFile;
                String sparkPyWorkDir;
                String mappingName     =  MappingUtils.generateValidName(physicalNode.getRootContainer().getName(), false, true, MapComponent.NAME_MAX_LENGTH);
                String mappingNameLong =  MappingUtils.generateValidName(physicalNode.getRootContainer().getName()+"_"+physicalNode.getPhysicalDesign().getName(), false, true, MapComponent.NAME_MAX_LENGTH);
                String sparkHome       =  null;
                
                def sparkExecutionUnit = physicalNode.getUpstreamConnectedNodes().get(0).getExecutionUnit()
                def logicalSchemaName  = sparkExecutionUnit.getLocation().getLogicalSchema().getName()
                def ekmOptions         = SparkUtils.getEKMOptions(sparkExecutionUnit)
                def includeJdbcJars    = generatorContext.getObject("mapping.spark.includeJdbcJars");
                    includeJdbcJars    = (includeJdbcJars != null && (includeJdbcJars instanceof Boolean ) && includeJdbcJars != false ) ? true : false;
                



                String sparkPyExecFile_groovy =sprintf('''<?{
                    String evalKMOption(optionValue, propertyName ) {
                        return ("<fromEUDataServer>".equals(optionValue) || "null".equals(optionValue))? odiRef.getDataServerPropertyFromLSchema(propertyName, "%1$s") : optionValue;
                    }
                    
                    String sparkPyExecFile = null;
                    
                    String  workDir          = odiRef.getDataServerPropertyFromLSchema("spark-work-dir", "%1$s");
                    String  sparkMaster      = odiRef.getDataServerInfo("DSERV_NAME", "%1$s");
                            sparkMaster      = (sparkMaster == null || sparkMaster.length() == 0) ? "local[2]" : sparkMaster;
                    boolean isModeStandalone = sparkMaster.startsWith("spark:");
                    boolean isModeYarn       = sparkMaster.startsWith("yarn");
                    String  pyfiles          = evalKMOption( "''' + ekmOptions.get("py-files") + '''", "py-files" );
                            pyfiles          = ((pyfiles != null && pyfiles.length()>0) ? (pyfiles+",") : "") + workDir +"/pyspark_ext.py";
                    String  files            = evalKMOption( "''' + ekmOptions.get("files") + '''", "files" );
                    String  deployMode       = odiRef.getDataServerPropertyFromLSchema("deploy-mode", "%1$s");
                    boolean isDeployClient   = sparkMaster.endsWith("client")  || deployMode.equals("client");
                    boolean isDeployCluster  = sparkMaster.endsWith("cluster") || deployMode.equals("cluster");
                    String  executorMem      = evalKMOption( "''' + ekmOptions.get("executor-memory") + '''", "executor-memory" );
                    String  driverCores      = evalKMOption( "''' + ekmOptions.get("driver-cores") + '''", "driver-cores" );
                    String  yarnExecCores    = evalKMOption( "''' + ekmOptions.get("executor-cores") + '''", "executor-cores" ); 
                    String  yarnNumExec      = evalKMOption( "''' + ekmOptions.get("num-executors") + '''", "num-executors" ); 
                    String  yarnPrincipal    = evalKMOption( "''' + ekmOptions.get("principal") + '''", "principal" ); 
                    String  yarnKeyTab       = evalKMOption( "''' + ekmOptions.get("keytab") + '''", "keytab" ); 
                    String  sparkHome        = odiRef.getDataServerPropertyFromLSchema("spark-home-dir", "%1$s"); 
                    
                    String  driverClassPath   = evalKMOption( "''' + ekmOptions.get("driver-class-path") + '''", "driver-class-path" ); 
                    String  driverJavaOptions = evalKMOption( "''' + ekmOptions.get("driver-java-options") + '''", "driver-java-options" );
                    String  driverLibraryPath = evalKMOption( "''' + ekmOptions.get("driver-library-path") + '''", "driver-library-path" ); 
                    String  driverMemory      = evalKMOption( "''' + ekmOptions.get("driver-memory") + '''", "driver-memory" ); 
                    String  executorClassPath = ""; // deprecated spark property
                    String  jars              = evalKMOption( "''' + ekmOptions.get("jars") + '''", "jars" );
                    
                    // Does this mapping use any SQL KMs and therefore require JDBC jars?
                    if ( ''' + includeJdbcJars + ''' ) {
                           jarsJdbc  = odiRef.listOdiSparkLib();
                           jarsJdbcA = jarsJdbc.split(java.util.regex.Pattern.quote(","));
                           for ( int i = 0; i < jarsJdbcA.length; i++ ) {
                               String fullFileName = jarsJdbcA[i];
                               String fileName = new File(jarsJdbcA[i]).getName();
                               // Adding jars to --jars is not required for yarn-cluster mode and for yarn-client, but this might change in later 
                               // Spark versions when a few yarn deployment related bugs get fixed.
                               // So just in case we keep adding them on --jars, as well:
                               jars              += ((jars != null && jars.length()>0) ? "," : "") + fullFileName;
                               pyfiles           += ((pyfiles != null && pyfiles.length()>0) ? "," : "") + fullFileName;
                               executorClassPath += ((executorClassPath != null && executorClassPath.length()>0) ? ":" : "") + fileName;
                               if ( isModeYarn && isDeployCluster ) {
                                   driverClassPath   += ((driverClassPath != null && driverClassPath.length()>0) ? ":" : "") + fileName;
                               } else {
                                   driverClassPath   += ((driverClassPath != null && driverClassPath.length()>0) ? ":" : "") + fullFileName;
                               }
                           };
                    };
                    
                    String propertiesFile     = evalKMOption( "''' + ekmOptions.get("properties-file") + '''", "properties-file" ); 
                    String conf               = evalKMOption( "''' + ekmOptions.get("conf") + '''", "conf" );
                    String verbose            = evalKMOption( "''' + ekmOptions.get("verbose") + '''", "verbose" );
                    String yarnQueue          = evalKMOption( "''' + ekmOptions.get("queue") + '''", "queue" );
                    String totalExecutorCores = evalKMOption( "''' + ekmOptions.get("total-executor-cores") + '''", "total-executor-cores" ); 

                         
                    sparkPyExecFile = sparkHome + "/bin/"  + "spark-submit --master " + sparkMaster;
                    if (deployMode != null && deployMode.length() > 0) { //deploy mode
                       sparkPyExecFile = sparkPyExecFile + " --deploy-mode " + deployMode;
                    }				  
                    if (pyfiles != null && pyfiles.length() > 0) { //more python files
                        sparkPyExecFile = sparkPyExecFile + " --py-files " + pyfiles;
                    }
                    if (files != null && files.length() > 0) { //more  files to put into working dir
                        sparkPyExecFile = sparkPyExecFile + " --files " +  files;
                    }
                    if (executorMem != null && executorMem.length() > 0) { //executor-memory
                        sparkPyExecFile = sparkPyExecFile + " --executor-memory " + executorMem;
                    }
                    if (propertiesFile != null && propertiesFile.length() > 0) { //properties-file
                        sparkPyExecFile = sparkPyExecFile + " --properties-file " + propertiesFile;
                    }
                    if (conf != null && conf.length() > 0) { //conf
                        sparkPyExecFile = sparkPyExecFile + " --conf " + conf;
                    }
                    if (verbose != null && verbose.length() > 0 && !verbose.equals("false")) { //verbose
                        sparkPyExecFile = sparkPyExecFile + " --verbose ";
                    }
                    if (driverClassPath != null && driverClassPath.length() > 0) { //driver-class-path
                        sparkPyExecFile = sparkPyExecFile + " --driver-class-path " + driverClassPath;
                    }
                    if (driverLibraryPath != null && driverLibraryPath.length() > 0) { //driver-library-path
                        sparkPyExecFile = sparkPyExecFile + " --driver-library-path " + driverLibraryPath;
                    }
                    if (driverJavaOptions != null && driverJavaOptions.length() > 0) { //driver-java-options
                        sparkPyExecFile = sparkPyExecFile + " --driver-java-options " + driverJavaOptions;
                    }
                    if (driverMemory != null && driverMemory.length() > 0) { //driver-memory
                        sparkPyExecFile = sparkPyExecFile + " --driver-memory " + driverMemory;
                    }
                    if (executorClassPath != null && executorClassPath.length() > 0) { //spark.executor.extraClassPath
                        sparkPyExecFile = sparkPyExecFile + " --conf spark.executor.extraClassPath=" + executorClassPath;
                    }
                    if (jars != null && jars.length() > 0) { //--jars
                        sparkPyExecFile = sparkPyExecFile + " --jars " + jars;
                    }
                    //Spark standalone with cluster only
                    if (sparkMaster.indexOf("spark:") >= 0 && deployMode != null && deployMode.indexOf("cluster") >= 0) {
                        if (driverCores != null && driverCores.length() > 0) { //driver-cores
                            sparkPyExecFile = sparkPyExecFile + " --driver-cores " + driverCores;
                         }
                     }
                    
                    //Spark standalone and Mesos only
                    if (sparkMaster.indexOf("spark:") >= 0 || sparkMaster.indexOf("mesos:") >= 0) {
                        if (totalExecutorCores != null && totalExecutorCores.length() > 0) { //total-executor-cores
                            sparkPyExecFile = sparkPyExecFile + " --total-executor-cores " + totalExecutorCores;
                        }
                    }
                    //Yarn only
                    if (sparkMaster.indexOf("yarn") >= 0) {
                        if (yarnExecCores != null && yarnExecCores.length() > 0) { //executor-cores
                            sparkPyExecFile = sparkPyExecFile + " --executor-cores " + yarnExecCores;
                        }
                        if (driverCores != null && driverCores.length() > 0) { //driver-cores
                            sparkPyExecFile = sparkPyExecFile + " --driver-cores " + driverCores;
	                    }
                        if (yarnNumExec != null && yarnNumExec.length() > 0) { //deploy mode
                            sparkPyExecFile = sparkPyExecFile + " --num-executors " + yarnNumExec;
                        }
                        if (yarnPrincipal != null && yarnPrincipal.length() > 0) { //principal
                            sparkPyExecFile = sparkPyExecFile + " --principal " + yarnPrincipal;
                        }
                        if (yarnKeyTab != null && yarnKeyTab.length() > 0) { //key tab
                            sparkPyExecFile = sparkPyExecFile + " --keytab " + yarnKeyTab;
                        }
                        if (yarnQueue != null && yarnQueue.length() > 0) { //queue
                            sparkPyExecFile = sparkPyExecFile + " --queue " + yarnQueue;
                        }
                    }
                  
                    sparkPyExecFile = sparkPyExecFile + " " + workDir + "/"+"%2$s"+".py" ;// default  generated mapping code will be in /tmp
				    out.print(sparkPyExecFile);
				}?>''',[logicalSchemaName,mappingNameLong]);
				  
                String workDir_groovy = sprintf('''<?{out.print(odiRef.getDataServerPropertyFromLSchema("spark-work-dir", "%1$s"));}?>''', [logicalSchemaName,mappingNameLong])
                
                String odiExecutionMode_groovy = sprintf('''<?{
                    String optionValue = "''' + ekmOptions.get("odi-execution-mode") + '''";
                    String odiExecutionMode = ("<fromEUDataServer>".equals(optionValue)|| "null".equals(optionValue))? odiRef.getDataServerPropertyFromLSchema("odi-execution-mode", "%1$s") : optionValue;
                    odiExecutionMode = (odiExecutionMode == null || odiExecutionMode.length()== 0 || !odiExecutionMode.equals("ASYNC")) ? "SYNC" : "ASYNC";

                    // BEGIN BDC REST SECTION
                    //String restMode = odiRef.getDataServerInfo("BDC_IS_SPARK_REST_JOB", "%1$s");
                    //odiExecutionMode = (restMode.equals("TRUE")) ? "REST" : odiExecutionMode ;
                    // END BDC REST SECTION
                    
                    out.print(odiExecutionMode);
                }?>''', [logicalSchemaName])

                String sparkEventLogEnabled_groovy = sprintf('''<?{
                    String optionValue    = "''' + ekmOptions.get("spark.eventLog.enabled") + '''";
                    String resultingValue = ("<fromEUDataServer>".equals(optionValue)|| "null".equals(optionValue))? odiRef.getDataServerPropertyFromLSchema("spark.eventLog.enabled", "%1$s") : optionValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                // BEGIN BDC REST SECTION

                String restIPAddress_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_URL", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])


                String restIdentityDomain_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_IDENTITY_DOMAIN", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restServiceInstance_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_SERVICE_INSTANCE", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restUserName_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_USER_NAME", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restPassword_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_PASSWORD", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restPhysicalSchema_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_PHYSICAL_SCHEMA", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restAdditionalClasspath_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("BDC_ADDITIONAL_CLASSPATH", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? null : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restLogicalSchema_groovy = sprintf('''<?{
                    String resultingValue = "%1$s";
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])



                variables.setVariable("restIPAddress",          restIPAddress_groovy);
                variables.setVariable("restIdentityDomain",     restIdentityDomain_groovy);
                variables.setVariable("restServiceInstance",    restServiceInstance_groovy);
                variables.setVariable("restUserName",           restUserName_groovy);
                variables.setVariable("restPassword",           restPassword_groovy);
                variables.setVariable("restPhysicalSchema",     restPhysicalSchema_groovy);
                variables.setVariable("restAdditionalClasspath",restAdditionalClasspath_groovy);
                
                // END BDC REST SECTION
			
                sparkPyFileName     = mappingNameLong + ".py" ;  
                sparkPyExecFileName = workDir_groovy + "/" + mappingNameLong + ".py" ;
                sparkPyOutFile      = workDir_groovy + "/" + mappingNameLong +".out" ;
                sparkPyErrFile      = workDir_groovy + "/" + mappingNameLong +".err" ;
                sparkPyWorkDir      = workDir_groovy  ;
				
                variables.setVariable("sparkpyFileName",      sparkPyFileName);
                variables.setVariable("sparkpyExecFileName",  sparkPyExecFileName);
                variables.setVariable("sparkPyExecFile",      sparkPyExecFile_groovy);
                variables.setVariable("sparkPyOutFile",       sparkPyOutFile);
                variables.setVariable("sparkPyErrFile",       sparkPyErrFile);
                variables.setVariable("sparkPyWorkDir",       sparkPyWorkDir);
                variables.setVariable("odiExecutionMode",     odiExecutionMode_groovy);
                variables.setVariable("sparkEventLogEnabled", sparkEventLogEnabled_groovy);
                variables.setVariable("logicalSchemaName", logicalSchemaName);

                String restDriverCores_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerPropertyFromLSchema("driver-cores", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restTotalExecutorCores_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerPropertyFromLSchema("executor-cores", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restNumExecutors_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerPropertyFromLSchema("num-executors", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String restDriverMemory_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerPropertyFromLSchema("driver-memory", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])
                
                String restExecutorMemory_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerPropertyFromLSchema("executor-memory", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])
                
                variables.setVariable("restDriverCores",        restDriverCores_groovy);
                variables.setVariable("restTotalExecutorCores", restTotalExecutorCores_groovy);
                variables.setVariable("restNumExecutors",       restNumExecutors_groovy);
                variables.setVariable("restDriverMemory",       restDriverMemory_groovy);
                variables.setVariable("restExecutorMemory",     restExecutorMemory_groovy);
                variables.setVariable("restMappingName",        mappingName);
                variables.setVariable("restMappingNameLong",    mappingNameLong);
                

                // BEGIN OBJECT STORAGE SECTION
                String strBucketName_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_BUCKET", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strTenantName_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_TENANT_NAME", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strTenantOCID_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_TENANT_OCID", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strUserOCID_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_USER_OCID", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strRegion_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_REGION", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strFingerprint_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_FINGERPRINT", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strPassPhrase_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_PASSPHRASE", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strPemFile_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_PRIVATE_KEY_PATH", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strIsObjectStorage_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("OBJECT_STORAGE_IS_DATA_SERVER", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strIsStorageCS_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_IS_DATA_SERVER", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSServiceURL_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_SERVICE_URL", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSServiceName_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_SERVICE_NAME", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSIdentityDomain_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_IDENTITY_DOMAIN", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSUsername_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_USERNAME", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSPassword_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_PASSWORD", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])

                String strStorageCSContainer_groovy = sprintf('''<?{
                    String resultingValue = odiRef.getDataServerInfo("STORAGE_CS_CONTAINER", "%1$s");
                    resultingValue =  (resultingValue == null || resultingValue.length()== 0) ? "NOT FOUND" : resultingValue;
                    out.print(resultingValue);
                }?>''', [logicalSchemaName])




                variables.setVariable("strIsObjectStorage",         strIsObjectStorage_groovy);
                variables.setVariable("strIsStorageCS",             strIsStorageCS_groovy);
                
                variables.setVariable("strStorageCSServiceURL",     strStorageCSServiceURL_groovy);
                variables.setVariable("strStorageCSServiceName",    strStorageCSServiceName_groovy);
                variables.setVariable("strStorageCSIdentityDomain", strStorageCSIdentityDomain_groovy);
                variables.setVariable("strStorageCSUsername",       strStorageCSUsername_groovy);
                variables.setVariable("strStorageCSPassword",       strStorageCSPassword_groovy);
                variables.setVariable("strStorageCSContainer",      strStorageCSContainer_groovy);


                variables.setVariable("strPemFile",     strPemFile_groovy);
                variables.setVariable("strTenantName",  strTenantName_groovy);
                variables.setVariable("strTenantId",    strTenantOCID_groovy);
                variables.setVariable("strUserId",      strUserOCID_groovy);
                variables.setVariable("strFingerprint", strFingerprint_groovy);
                variables.setVariable("strPassPhrase",  strPassPhrase_groovy);
                variables.setVariable("strRegion",      strRegion_groovy);
                variables.setVariable("strBucketName",  strBucketName_groovy);

                String restApplicationPyFile_final   = "pyspark_ext.py";
                variables.setVariable("restApplicationPyFile",   restApplicationPyFile_final);
                
                // END BDC REST SECTION

		// generateOdiOsCommand()
		}
		
		   public void generateDeployJdbcJars(MapPhysicalNode physicalNode, Binding variables) {
                String jarKeys;                
                def sparkExecutionUnit = physicalNode.getUpstreamConnectedNodes().get(0).getExecutionUnit()
                def logicalSchemaName  = sparkExecutionUnit.getLocation().getLogicalSchema().getName()
                def ekmOptions         = SparkUtils.getEKMOptions(sparkExecutionUnit)
                def includeJdbcJars    = generatorContext.getObject("mapping.spark.includeJdbcJars");
                    includeJdbcJars    = (includeJdbcJars != null && (includeJdbcJars instanceof Boolean ) && includeJdbcJars != false ) ? true : false;
                
                if (includeJdbcJars) {
                    String jarKeysJdbc_groovy =sprintf('''<?{
                        String evalKMOption(optionValue, propertyName ) {
                            return ("<fromEUDataServer>".equals(optionValue) || "null".equals(optionValue))? odiRef.getDataServerPropertyFromLSchema(propertyName, "%1$s") : optionValue;
                        }
                        
                        String jarKeysJdbc = evalKMOption( "''' + ekmOptions.get("jars-odi-jdbc") + '''", "jars-odi-jdbc" );
                        out.print( jarKeysJdbc );
                        }?>''', logicalSchemaName)
                    variables.setVariable("jarKeysJdbc",  jarKeysJdbc_groovy);
                }
		}
		
		public AbstractSyntaxTree getLKMStoreScript(SparkScript storeScript){
	        Set<String> targetNames = new HashSet<String>();
        
	        for (MapPhysicalNode targetNode: physicalNode.getAllDownstreamNodes()) {
	             if (!targetNode.isTargetNode() || targetNode.isAPNode()) {
	                  continue;
	             }
	             targetNames.add(targetNode.getLogicalComponentName());
	        }
	        storeScript.setDestinationTargets(targetNames);
	        	
        	
          Map<MapPhysicalNode, SparkScript> apStoreScripts = (Map<MapPhysicalNode, SparkScript>)generatorContext.getObject("mapping.store.scripts");
            
            if (apStoreScripts == null) {
            
                 apStoreScripts = new HashMap<MapPhysicalNode,SparkScript>();
            
                 MapPhysicalDesign physicalDesign = physicalNode.getPhysicalDesign();
                 List<ExecutionUnit> targetExeUnits = physicalDesign.getTargetExUnitList(); 
            
                 for (ExecutionUnit exUnit : targetExeUnits) {
                      
                      List<MapPhysicalNode> apNodes = exUnit.getAPNodes();
                      for (MapPhysicalNode apNode : apNodes) 
                            apStoreScripts.put(apNode, null);  
                            
                }
                            
                if (apStoreScripts.size() > 1) {
                
                   generatorContext.putObject("mapping.store.scripts", apStoreScripts);
                }
                else return storeScript;
                            
            }
            
            
            apStoreScripts.put(physicalNode, storeScript);
            
            boolean execCompleted = true;
            for (SparkScript pScript : apStoreScripts.values()) {
                if (pScript == null) {
                    execCompleted = false;
                    break;
                 }
            
            }
            
            if (execCompleted) {
            
                 SparkScript wrapperScript = new SparkScript(storeScript.getTemplateUtils(), null);
                 for (SparkScript pScript : apStoreScripts.values()) { 
                     wrapperScript.addChild(pScript);
                 }
                      
                 return wrapperScript;
            }else{
            		Map<MapPhysicalNode, Boolean> targetExec = (Map<MapPhysicalNode, Boolean>)generatorContext.getObject("mapping.target.exec");
      					if (targetExec == null)
              		targetExec = new HashMap<MapPhysicalNode,Boolean>();
              	targetExec.put(physicalNode,false);
             		generatorContext.putObject("mapping.target.exec", targetExec);	
              	return new NullTarget(); 
            }
    }
    
    public Boolean skipTask(){
        Map<MapPhysicalNode, Boolean> targetExec = (Map<MapPhysicalNode, Boolean>)generatorContext.getObject("mapping.target.exec");
        if (targetExec != null && targetExec.get(physicalNode) == false )
            return true;
        return false;
    }
    
    public Boolean skipDeployJarTask(){
        Boolean includeJdbcJars = (Boolean)generatorContext.getObject("mapping.spark.includeJdbcJars");
        if (skipTask() || includeJdbcJars==null || includeJdbcJars==false )
            return true;
        return false;
    }

		public String getSparkDataServerProperty(String propKey) throws oracle.odi.km.exception.OdiKMException {
		    String propValue = getSparkDataServerProperty(propKey, null);
			if (propValue == null) {
			    throw new oracle.odi.km.exception.OdiKMException('Property' + propKey + 'Cannot be found.');
			}
			return propValue;
		}
		
		public String getSparkDataServerProperty(String propKey, String defaultValue) {
			Map<String, String> sparkParams = getSparkDataServerProperties();
			return sparkParams.get(propKey) == null ? defaultValue : sparkParams.get(propKey);
		}
		
		protected Map<String, String> getSparkDataServerProperties() {
			Map<String, String> sparkParams = SparkUtils.getSparkDataServerProperties(physicalNode.getPhysicalDesign());
			if (System.getProperty("SPARK_MASTER") !=null) {
			    String serverInstanceName = System.getProperty("SPARK_MASTER");
			    sparkParams.put("serverInstanceName", serverInstanceName);
			}
			return sparkParams;
		}
		
		@ASTProducerMethod(processingType=ProcessingType.SOURCE, producedASTType=NullTarget.class, styleKey="ProcessingStyleKey.POST_LOAD_TAP")
		AbstractSyntaxTree POST_LOAD_TAP(SparkScript inputScript) {
			AbstractSyntaxTree result = new NullTarget();
			result.setUpstreamAST(inputScript);
			return  result;
		}
		
		public void supportDataFrames (String kmName, boolean enabled) {
		   if (SparkUtils.useDataFrames(physicalNode.getPhysicalDesign()) && !enabled) {
			throw new OdiKMException("ERROR : " + kmName + " does not support Spark DataFrames feature. Set Spark Execution Unit property spark.useDataFrames to false.");
		   }
		}
		
		public boolean isDataFramesEnabled () {
		   return SparkUtils.useDataFrames(physicalNode.getPhysicalDesign());
		}
	}
		

		]]></Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2021-08-27 16:25:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUNOPSIS_INSTALL]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[739e7da4-f732-4455-8936-782fafe91869]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndExcludeExUnitBegin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndExcludeExUnitEnd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndExcludeExUnitMain" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndExcludeMapBegin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndExcludeMapCleanup" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndExcludeMapEnd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String">null</Field>
	<Field name="IndSuppSetBased" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[801]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmLang" type="java.lang.String"><![CDATA[PYTHON]]></Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[SPARK_PYTHON]]></Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2021-08-27 16:26:59.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUNOPSIS_INSTALL]]></Field>
	<Field name="LkmType" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String"><![CDATA[*]]></Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[SparkKM]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[CK]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExitGroup">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[fe76bf2d-336b-423f-b83c-8264473ad977]]></Field>
	<Field name="GroupName" type="java.lang.String"><![CDATA[Performance]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[802]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7fd8a217-3a86-4631-85fe-a981a924e7da]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[803]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[298]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Cache]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Cache RDD/DataFrame across operations after computation]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[835b60e9-17f1-4788-96c4-75161a4720ef]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[802]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return "show=true,enable=true";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Column description]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_COL_DESC]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_COL]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f20b4eab-bed7-434d-a204-80ae62eac033]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[803]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
Cache this RDD/DataFrame across operations after transform with this component for default storage level
or persist this RDD/DataFrame with an user defined storage level.

       ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[User Exit help]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_UE_HELP]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_USER_EXIT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[804]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d73407de-7729-4da1-8a7b-865686c0f1ae]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[805]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[806]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[299]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[Default]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Storage Level]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[The storage level to be used to cache data]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b12b915b-a7fc-4a52-aaf4-53fb86bc268d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[804]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return options.getValue("Cache").equals("true")?"show=true,enable=true":"show=false,enable=false";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2b4b020b-cfd9-48bf-9479-3173419b3570]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[806]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Default, DISK_ONLY, DISK_ONLY_2, MEMORY_ONLY, MEMORY_ONLY_2, MEMORY_ONLY_SER, MEMORY_ONLY_SER_2, MEMORY_AND_DISK, MEMORY_AND_DISK_2, MEMORY_AND_DISK_SER, MEMORY_AND_DISK_SER_2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Text value]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_VALUE]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_USER_EXIT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[adc80331-3500-4501-a742-22541de8df02]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[805]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[807]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[003284dc-a508-4022-a1de-e6bd06faf925]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[808]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Repartition]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Repartiton the rdd/dataframe after transform of this component]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e648cc2d-fe5c-42ac-80a0-3e0080c19ba3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[807]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return (isStreaming)?"show=false,enable=false":"show=true,enable=true";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c947131e-590a-4b25-9ccd-a5ecd5905bb3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[808]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
Increase or decrease the level of parallelism in this RDD/DataFrame. 

            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[809]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ba5c3448-0998-4123-ac5d-609462618a48]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[810]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[default]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Level of Parallelism]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Number of partitions]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3210467f-c9c0-4c5e-b67d-3aeddccde373]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[809]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return (isStreaming)?"show=false,enable=false":"show=true,enable=true";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6d57beaa-aafd-4f6d-ba42-307548088e3e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[810]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
Number of partitions, default is 0. This parameter is used to invoke Spark function - repartition(numPartitions). 
This parameter is also used as the numPartition arugment of some transformations that triggers stage 
boundary such as join and sortBy. When default value is set, spark.default.parallelism will be used to
invoke repartition() function. 
            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[811]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1a0df567-87d6-4c14-b84b-4a93f8cc1c02]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[812]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[302]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Sort Partitions]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Sort partitions by a key function when repartitioning]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[147aa270-7c8c-45af-a95a-b42e953765c7]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[811]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return ((!isStreaming) && (options.getValue("Repartition").equals("true")))?"show=true,enable=true":"show=false,enable=false";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9ece27fa-e1c1-4716-a10a-568dd6bc413d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[812]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
This option is only used when DataFrames are disabled.            

            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[813]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[67427c60-34fd-4c93-86e5-aacd6d0094e8]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[814]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[815]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[Ascending]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Partition Sort Order]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Sort partitions order]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[72d54d8c-0fd3-413b-97cd-6cef3aca0a04]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[813]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return ((!isStreaming) && (options.getValue("Sort Partitions").equals("true")))?"show=true,enable=true":"show=false,enable=false";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cdcc42d7-735a-48a6-86ff-45d6f74512a5]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[815]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Ascending, Descending]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2d52762e-c8b8-4d01-9eea-46083d3806e9]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[814]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
This option is only used when DataFrames are disabled.            

            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[816]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c361647c-491a-42e9-8b4f-0f22108c6e03]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[817]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[818]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Partition Keys]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Define keys for partitions]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3c885122-96a4-4e84-be1b-b13e108d41df]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[816]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return ((!isStreaming) && (options.getValue("Repartition").equals("true")))?"show=true,enable=true":"show=false,enable=false";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[761e48f0-f4a6-4a5c-8a6e-f3270b4faf99]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[818]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[766a9427-41f8-4e3d-90f3-b9881d61301d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[817]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
This option is used to define partition keys. Partition key definition is comma separated attribute list. 
Given an example mapping which has two source tables:
   order
            \
            join -> filter -> tgt
            /  
order_detail

the partition key definition could be "order.year,order.month,order_detail.day", this will do repartioning based on year,month
columns of order table and day column of order_detail table.
If you apply Partition Keys on target node, use target node attributes without prefix to build the partition list.
For RDDs when partition key definition contains more than one column partition function must be provided. See option Partition Function

            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[819]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e210b337-b0f2-4f8e-b6ff-606529ae9d42]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[133]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[820]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[821]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[26]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[Partition Function]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Customized partitioning function]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[95e1a63d-aed3-4249-a043-6aa95486b6f2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[819]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[105]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[return ((!isStreaming) && (options.getValue("Repartition").equals("true")))?"show=true,enable=true":"show=false,enable=false";]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bb8c57f1-3507-4950-831e-609daf16c200]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[821]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[860ef5d2-a7f7-4a5d-a9c2-35050f51e769]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[820]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[
This option is used to provide partitoining key transform function. This key transform function must be a python lambda
function. Default is RDD.portable_hash. Given a simple source to target example mapping- src -> filter -> tgt, and key 
definition is "src.year,src.month,src.day", partitioning function can be defined as "lambda x : x[0]*365+x[1]*31+x[2]". 
return values of partition function must be numbers.
This option is only used when DataFrames are disabled. 

            ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d7e8c1da-bc8f-417f-bada-2924220a93d2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[801]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Edit Command]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_TRT_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.801]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d7e8c1da-bc8f-417f-bada-2924220a93d2]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.133]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[739e7da4-f732-4455-8936-782fafe91869]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[SparkKM]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.803]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f20b4eab-bed7-434d-a204-80ae62eac033]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXITGROUP.26]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fe76bf2d-336b-423f-b83c-8264473ad977]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[SparkKM.Performance]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_USEREXITGROUP]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[7.11]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.802]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[835b60e9-17f1-4788-96c4-75161a4720ef]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.805]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[adc80331-3500-4501-a742-22541de8df02]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.806]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2b4b020b-cfd9-48bf-9479-3173419b3570]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.804]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b12b915b-a7fc-4a52-aaf4-53fb86bc268d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.105]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.111]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.808]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c947131e-590a-4b25-9ccd-a5ecd5905bb3]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.807]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e648cc2d-fe5c-42ac-80a0-3e0080c19ba3]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.810]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6d57beaa-aafd-4f6d-ba42-307548088e3e]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.809]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3210467f-c9c0-4c5e-b67d-3aeddccde373]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.812]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9ece27fa-e1c1-4716-a10a-568dd6bc413d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.811]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[147aa270-7c8c-45af-a95a-b42e953765c7]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.814]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2d52762e-c8b8-4d01-9eea-46083d3806e9]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.815]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[cdcc42d7-735a-48a6-86ff-45d6f74512a5]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.813]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[72d54d8c-0fd3-413b-97cd-6cef3aca0a04]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.110]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.817]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[766a9427-41f8-4e3d-90f3-b9881d61301d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.818]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[761e48f0-f4a6-4a5c-8a6e-f3270b4faf99]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.816]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3c885122-96a4-4e84-be1b-b13e108d41df]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.820]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[860ef5d2-a7f7-4a5d-a9c2-35050f51e769]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.821]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[bb8c57f1-3507-4950-831e-609daf16c200]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.819]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[95e1a63d-aed3-4249-a043-6aa95486b6f2]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[21]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[18]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[21]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.09]]></Field>
</Object>
</SunopsisExport>
